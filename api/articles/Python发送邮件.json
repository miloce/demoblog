{"title":"Python发送邮件","uid":"5d2cae0b2edfc85d0a8cc862969d7e7f","slug":"Python发送邮件","date":"2022-05-12T09:51:00.000Z","updated":"2023-01-13T15:59:16.000Z","comments":true,"path":"api/articles/Python发送邮件.json","keywords":"C语言,Cpp,Linux,GoPython,算法,编程技术","cover":null,"content":"<h1 id=\"Python发送邮件\"><a href=\"#Python发送邮件\" class=\"headerlink\" title=\"Python发送邮件\"></a>Python发送邮件</h1><p><a href=\"https://docs.python.org/3.10/library/smtplib.html\">smtplib</a> 是 Python 用来发送邮件的模块，<a href=\"https://docs.python.org/3.10/library/email.html\">email</a> 是用来处理邮件消息</p>\n<p>这里，我们使用<a href=\"https://blog.csdn.net/qq_62789540/article/details/124513178?spm=1001.2014.3001.5501\">装饰器</a>来制作发送邮件的功能</p>\n<h2 id=\"一、-文本信息\"><a href=\"#一、-文本信息\" class=\"headerlink\" title=\"一、 文本信息\"></a>一、 文本信息</h2><p>我们使用<code>MIMEText</code>来发送文本信息</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> smtplib <span class=\"keyword\">import</span> SMTP</span><br><span class=\"line\"><span class=\"keyword\">from</span> email.mime.text <span class=\"keyword\">import</span> MIMEText  <span class=\"comment\"># 发送文本信息使用的库</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> email.header <span class=\"keyword\">import</span> Header  <span class=\"comment\"># 设置请求的头部信息</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> email.utils <span class=\"keyword\">import</span> formataddr  <span class=\"comment\"># 格式化</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> functools <span class=\"keyword\">import</span> wraps</span><br><span class=\"line\"></span><br><span class=\"line\">receivers = [<span class=\"string\">&#x27;a.l.kun@qq.com&#x27;</span>,]  <span class=\"comment\"># 接收者为可迭代对象，可以实现邮件的群发</span></span><br><span class=\"line\">subject = <span class=\"string\">&#x27;测试邮件&#x27;</span>  <span class=\"comment\"># 设置邮件的标题</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">decorate</span>(<span class=\"params\">fun_</span>):</span><br><span class=\"line\">    </span><br><span class=\"line\">    username = <span class=\"string\">&#x27;2855595515@qq.com&#x27;</span>  <span class=\"comment\"># 发送邮件的qq号</span></span><br><span class=\"line\">    password_pass = <span class=\"string\">&#x27;meryyupicqjjciei&#x27;</span>  <span class=\"comment\"># 授权密码，有的邮箱是使用登录密码</span></span><br><span class=\"line\">    smtp = SMTP(<span class=\"string\">&#x27;smtp.qq.com&#x27;</span>)  <span class=\"comment\"># 创建一个SMTP服务器，这里使用qq邮箱</span></span><br><span class=\"line\">    smtp.login(username, password_pass)  <span class=\"comment\"># 登录</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"meta\">    @wraps(<span class=\"params\">fun_</span>)</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">func_mail</span>(<span class=\"params\">*args, **kwargs</span>):</span><br><span class=\"line\">        fun_(smtp, username, *args, **kwargs)  <span class=\"comment\"># 调用发邮件的函数</span></span><br><span class=\"line\">        smtp.quit()  <span class=\"comment\"># 关闭服务器</span></span><br><span class=\"line\">        smtp.close()  </span><br><span class=\"line\">    <span class=\"keyword\">return</span> func_mail</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@decorate</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">mail</span>(<span class=\"params\">smtp, username</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> receiver_ <span class=\"keyword\">in</span> receivers:</span><br><span class=\"line\">        msgRoot = MIMEText(<span class=\"string\">f&quot;这是一个测试邮件，不要回复哦~~~&quot;</span>, <span class=\"string\">&quot;html&quot;</span>, <span class=\"string\">&quot;utf-8&quot;</span>)  <span class=\"comment\"># 如果第二个参数为plain，则是发送纯文本信息，如果邮件有中文，就要使用utf-8</span></span><br><span class=\"line\">        msgRoot[<span class=\"string\">&quot;Subject&quot;</span>] = Header(subject, <span class=\"string\">&quot;utf-8&quot;</span>)  <span class=\"comment\"># 设置文本标题</span></span><br><span class=\"line\">        msgRoot[<span class=\"string\">&#x27;From&#x27;</span>] = formataddr((<span class=\"string\">&quot;A.L.Kun&quot;</span>, username))  <span class=\"comment\"># 设置发件人信息</span></span><br><span class=\"line\">        msgRoot[<span class=\"string\">&#x27;To&#x27;</span>] = formataddr((receiver_.split(<span class=\"string\">&quot;@&quot;</span>)[<span class=\"number\">0</span>], receiver_))  <span class=\"comment\"># 设置收件人信息</span></span><br><span class=\"line\">        smtp.sendmail(username, receiver_, msgRoot.as_string())  <span class=\"comment\"># 发送邮件</span></span><br><span class=\"line\">        <span class=\"comment\"># smtp.set_debuglevel(1)  # 输出调试信息</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(receiver_.split(<span class=\"string\">&quot;@&quot;</span>)[<span class=\"number\">0</span>], <span class=\"string\">&#x27;:发送完成&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    mail()</span><br></pre></td></tr></table></figure>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>使用装饰器的好处，可以动态创建一个发送邮件的对象，同时可以不用关注邮件的配置，只要关注邮件的内容</p></blockquote>\n<h2 id=\"二、-图片信息\"><a href=\"#二、-图片信息\" class=\"headerlink\" title=\"二、 图片信息\"></a>二、 图片信息</h2><p>我们可以使用<code>MIMEImage</code>来读取图片数据，然后进行发送</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> smtplib <span class=\"keyword\">import</span> SMTP</span><br><span class=\"line\"><span class=\"keyword\">from</span> email.mime.text <span class=\"keyword\">import</span> MIMEText  <span class=\"comment\"># 发送文本信息使用的库</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> email.mime.multipart <span class=\"keyword\">import</span> MIMEMultipart  <span class=\"comment\"># 可以发送多种类型的邮件</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> email.mime.image <span class=\"keyword\">import</span> MIMEImage  <span class=\"comment\"># 读取图片信息</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> email.header <span class=\"keyword\">import</span> Header  </span><br><span class=\"line\"><span class=\"keyword\">from</span> email.utils <span class=\"keyword\">import</span> formataddr  </span><br><span class=\"line\"><span class=\"keyword\">from</span> functools <span class=\"keyword\">import</span> wraps</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"></span><br><span class=\"line\">receivers = [<span class=\"string\">&#x27;a.l.kun@qq.com&#x27;</span>,]</span><br><span class=\"line\">subject = <span class=\"string\">&#x27;测试邮件&#x27;</span></span><br><span class=\"line\">pic_path = <span class=\"string\">&quot;./test.jpeg&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">decorate</span>(<span class=\"params\">fun_</span>):</span><br><span class=\"line\">    username = <span class=\"string\">&#x27;2855595515@qq.com&#x27;</span></span><br><span class=\"line\">    password_pass = <span class=\"string\">&#x27;mdsrecuicqjjciei&#x27;</span></span><br><span class=\"line\">    smtp = SMTP(<span class=\"string\">&#x27;smtp.qq.com&#x27;</span>)</span><br><span class=\"line\">    smtp.login(username, password_pass)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">    @wraps(<span class=\"params\">fun_</span>)</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">func_mail</span>(<span class=\"params\">*args, **kwargs</span>):</span><br><span class=\"line\">        fun_(smtp, username, *args, **kwargs)</span><br><span class=\"line\">        smtp.quit()</span><br><span class=\"line\">        smtp.close()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> func_mail</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@decorate</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">mail</span>(<span class=\"params\">smtp, username</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> receiver_ <span class=\"keyword\">in</span> receivers:</span><br><span class=\"line\">        msgRoot = MIMEMultipart(<span class=\"string\">&quot;related&quot;</span>)  <span class=\"comment\"># 创建一个容器，可以为related模式，可以往里面添加文本、图片、附件</span></span><br><span class=\"line\">        msgRoot[<span class=\"string\">&quot;Subject&quot;</span>] = Header(subject, <span class=\"string\">&quot;utf-8&quot;</span>)</span><br><span class=\"line\">        msgRoot[<span class=\"string\">&#x27;From&#x27;</span>] = formataddr((<span class=\"string\">&quot;A.L.Kun&quot;</span>, username))</span><br><span class=\"line\">        msgRoot[<span class=\"string\">&#x27;To&#x27;</span>] = formataddr((receiver_.split(<span class=\"string\">&quot;@&quot;</span>)[<span class=\"number\">0</span>], receiver_))</span><br><span class=\"line\">        pic_data = <span class=\"built_in\">open</span>(pic_path, <span class=\"string\">&quot;rb&quot;</span>).read()  <span class=\"comment\"># 读取图片数据</span></span><br><span class=\"line\">        <span class=\"string\">&quot;&quot;&quot;以附件的形式发送图片&quot;&quot;&quot;</span></span><br><span class=\"line\">        send_img_f = MIMEImage(pic_data)</span><br><span class=\"line\">        <span class=\"comment\"># 设置头部信息，第一个参数和第二个参数都表示以附件的形式发送，最后一个表示文件的文件名</span></span><br><span class=\"line\">        <span class=\"comment\"># 只要设置了这个头部信息，就是为发送附件</span></span><br><span class=\"line\">        send_img_f.add_header(<span class=\"string\">&#x27;Content-Disposition&#x27;</span>, <span class=\"string\">&#x27;attachment&#x27;</span>, filename=(<span class=\"string\">&#x27;utf-8&#x27;</span>, <span class=\"string\">&#x27;&#x27;</span>, os.path.basename(pic_path)))</span><br><span class=\"line\">        msgRoot.attach(send_img_f)  <span class=\"comment\"># 将图片附件添加到容器中</span></span><br><span class=\"line\">        <span class=\"string\">&quot;&quot;&quot;将图片添加到正文中&quot;&quot;&quot;</span></span><br><span class=\"line\">        send_img_c = MIMEImage(pic_data)</span><br><span class=\"line\">        <span class=\"comment\"># 设置图片的唯一标识，即图片的id为img1，通过`cid:img1`访问</span></span><br><span class=\"line\">        send_img_c.add_header(<span class=\"string\">&quot;Content-Id&quot;</span>, <span class=\"string\">&quot;&lt;img1&gt;&quot;</span>)</span><br><span class=\"line\">        msgRoot.attach(send_img_c)  <span class=\"comment\"># 要先将图片数据上传到容器中</span></span><br><span class=\"line\">        img_text = <span class=\"string\">f&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">            &lt;p&gt;这是一张图片：&lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"string\">            &lt;br&gt;&lt;img src=&quot;cid:img1&quot; width=&quot;300&quot; alt=<span class=\"subst\">&#123;os.path.basename(pic_path)&#125;</span>&gt;&lt;/br&gt;</span></span><br><span class=\"line\"><span class=\"string\">        &quot;&quot;&quot;</span>  <span class=\"comment\"># 使用导入的图片数据</span></span><br><span class=\"line\">        msgRoot.attach(MIMEText(img_text, <span class=\"string\">&quot;html&quot;</span>, <span class=\"string\">&quot;utf-8&quot;</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">        smtp.sendmail(username, receiver_, msgRoot.as_string())</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(receiver_.split(<span class=\"string\">&quot;@&quot;</span>)[<span class=\"number\">0</span>], <span class=\"string\">&#x27;:发送完成&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    mail()</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"三、-附件\"><a href=\"#三、-附件\" class=\"headerlink\" title=\"三、 附件\"></a>三、 附件</h2><p>我们使用<code>MIMEApplication</code>来发送附件</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> smtplib <span class=\"keyword\">import</span> SMTP</span><br><span class=\"line\"><span class=\"keyword\">from</span> email.mime.multipart <span class=\"keyword\">import</span> MIMEMultipart</span><br><span class=\"line\"><span class=\"keyword\">from</span> email.header <span class=\"keyword\">import</span> Header</span><br><span class=\"line\"><span class=\"keyword\">from</span> email.mime.application <span class=\"keyword\">import</span> MIMEApplication  <span class=\"comment\"># 发送二进制附件</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> email.utils <span class=\"keyword\">import</span> formataddr</span><br><span class=\"line\"><span class=\"keyword\">from</span> functools <span class=\"keyword\">import</span> wraps</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"></span><br><span class=\"line\">receivers = [<span class=\"string\">&#x27;a.l.kun@qq.com&#x27;</span>,]</span><br><span class=\"line\">subject = <span class=\"string\">&#x27;测试邮件&#x27;</span></span><br><span class=\"line\">file_lis = [<span class=\"string\">&quot;./test2.pptx&quot;</span>, <span class=\"string\">&quot;./test.jpeg&quot;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">decorate</span>(<span class=\"params\">fun_</span>):</span><br><span class=\"line\">    username = <span class=\"string\">&#x27;2855595515@qq.com&#x27;</span></span><br><span class=\"line\">    password_pass = <span class=\"string\">&#x27;mwdftrtycqjjciei&#x27;</span></span><br><span class=\"line\">    smtp = SMTP(<span class=\"string\">&#x27;smtp.qq.com&#x27;</span>)</span><br><span class=\"line\">    smtp.login(username, password_pass)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">    @wraps(<span class=\"params\">fun_</span>)</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">func_mail</span>(<span class=\"params\">*args, **kwargs</span>):</span><br><span class=\"line\">        fun_(smtp, username, *args, **kwargs)</span><br><span class=\"line\">        smtp.quit()</span><br><span class=\"line\">        smtp.close()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> func_mail</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@decorate</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">mail</span>(<span class=\"params\">smtp, username</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> receiver_ <span class=\"keyword\">in</span> receivers:</span><br><span class=\"line\">        msgRoot = MIMEMultipart(<span class=\"string\">&quot;related&quot;</span>)  <span class=\"comment\"># 创建一个容器，必须为related模式，可以往里面添加文本、图片、附件</span></span><br><span class=\"line\">        msgRoot[<span class=\"string\">&quot;Subject&quot;</span>] = Header(subject, <span class=\"string\">&quot;utf-8&quot;</span>)</span><br><span class=\"line\">        msgRoot[<span class=\"string\">&#x27;From&#x27;</span>] = formataddr((<span class=\"string\">&quot;A.L.Kun&quot;</span>, username))</span><br><span class=\"line\">        msgRoot[<span class=\"string\">&#x27;To&#x27;</span>] = formataddr((receiver_.split(<span class=\"string\">&quot;@&quot;</span>)[<span class=\"number\">0</span>], receiver_))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> file <span class=\"keyword\">in</span> file_lis:</span><br><span class=\"line\">            <span class=\"comment\"># 创建二进制文件数据</span></span><br><span class=\"line\">            msgFile = MIMEApplication(<span class=\"built_in\">open</span>(file, <span class=\"string\">&quot;rb&quot;</span>).read())</span><br><span class=\"line\">            <span class=\"comment\"># 设置标头</span></span><br><span class=\"line\">            msgFile.add_header(<span class=\"string\">&#x27;Content-Disposition&#x27;</span>, <span class=\"string\">&#x27;attachment&#x27;</span>, filename=(<span class=\"string\">&#x27;utf-8&#x27;</span>, <span class=\"string\">&#x27;&#x27;</span>, os.path.basename(file)))</span><br><span class=\"line\">            <span class=\"comment\"># 将数据添加到容器中</span></span><br><span class=\"line\">            msgRoot.attach(msgFile)</span><br><span class=\"line\"></span><br><span class=\"line\">        smtp.sendmail(username, receiver_, msgRoot.as_string())</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(receiver_.split(<span class=\"string\">&quot;@&quot;</span>)[<span class=\"number\">0</span>], <span class=\"string\">&#x27;:发送完成&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    mail()</span><br></pre></td></tr></table></figure>","feature":true,"text":"Python发送邮件smtplib 是 Python 用来发送邮件的模块，email 是用来处理邮件消息 这里，我们使用装饰器来制作发送邮件的功能 一、 文本信...","permalink":"/post/Python发送邮件","photos":[],"count_time":{"symbolsCount":"6k","symbolsTime":"5 mins."},"categories":[{"name":"技术教程","slug":"技术教程","count":4,"path":"api/categories/技术教程.json"}],"tags":[{"name":"python","slug":"python","count":1,"path":"api/tags/python.json"},{"name":"邮箱","slug":"邮箱","count":1,"path":"api/tags/邮箱.json"},{"name":"函数","slug":"函数","count":1,"path":"api/tags/函数.json"},{"name":"smtp","slug":"smtp","count":1,"path":"api/tags/smtp.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Python%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6\"><span class=\"toc-text\">Python发送邮件</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81-%E6%96%87%E6%9C%AC%E4%BF%A1%E6%81%AF\"><span class=\"toc-text\">一、 文本信息</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E3%80%81-%E5%9B%BE%E7%89%87%E4%BF%A1%E6%81%AF\"><span class=\"toc-text\">二、 图片信息</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%89%E3%80%81-%E9%99%84%E4%BB%B6\"><span class=\"toc-text\">三、 附件</span></a></li></ol></li></ol>","author":{"name":"Miloce","slug":"blog-author","avatar":"https://q1.qlogo.cn/g?b=qq&nk=2855595515&s=640","link":"/","description":"我们徜徉在璀璨夺目的星辰之下，乘风破浪驰骋在这比特之海","socials":{"github":"https://github.com/miloce","twitter":"https://x.com/jystnet?s=09","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/7647256486","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"iconfont icon-bilibili-fill","link":"https://space.bilibili.com/518758949"},"douyin":{"icon":"iconfont icon-douyin","link":"https://www.douyin.com/user/MS4wLjABAAAA2ti_VUrbdGrI4X2IAXbXs5PI9Yb8XsU0eR5hrI_TGtg"},"QQ":{"icon":"iconfont icon-QQ","link":"https://wpa.qq.com/msgrd?v=3&uin=2855595515&site=qq&menu=yes&jumpflag=1"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"堵猫猫小游戏","uid":"cda5e3e392219da3a1a5b517de2ad603","slug":"堵猫猫小游戏","date":"2023-01-13T17:02:56.000Z","updated":"2023-01-13T17:52:04.000Z","comments":true,"path":"api/articles/堵猫猫小游戏.json","keywords":"C语言,Cpp,Linux,GoPython,算法,编程技术","cover":null,"text":"捉住小猫 游戏玩法 点击小圆点，围住小猫。 你点击一次，小猫走一次。 直到你把小猫围住（赢），或者小猫走到边界并逃跑（输）。 源代码游戏源代码点击下载 ","permalink":"/post/堵猫猫小游戏","photos":[],"count_time":{"symbolsCount":80,"symbolsTime":"1 mins."},"categories":[{"name":"源码分享","slug":"源码分享","count":1,"path":"api/categories/源码分享.json"}],"tags":[{"name":"堵猫猫","slug":"堵猫猫","count":1,"path":"api/tags/堵猫猫.json"},{"name":"小游戏","slug":"小游戏","count":1,"path":"api/tags/小游戏.json"},{"name":"源代码","slug":"源代码","count":1,"path":"api/tags/源代码.json"}],"author":{"name":"Miloce","slug":"blog-author","avatar":"https://q1.qlogo.cn/g?b=qq&nk=2855595515&s=640","link":"/","description":"我们徜徉在璀璨夺目的星辰之下，乘风破浪驰骋在这比特之海","socials":{"github":"https://github.com/miloce","twitter":"https://x.com/jystnet?s=09","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/7647256486","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"iconfont icon-bilibili-fill","link":"https://space.bilibili.com/518758949"},"douyin":{"icon":"iconfont icon-douyin","link":"https://www.douyin.com/user/MS4wLjABAAAA2ti_VUrbdGrI4X2IAXbXs5PI9Yb8XsU0eR5hrI_TGtg"},"QQ":{"icon":"iconfont icon-QQ","link":"https://wpa.qq.com/msgrd?v=3&uin=2855595515&site=qq&menu=yes&jumpflag=1"}}}},"feature":true},"next_post":{"title":"Linux 实用命令","uid":"f5ef2525f20c0d8b39c411893fc255bb","slug":"Linux-实用命令","date":"2022-05-12T09:03:00.000Z","updated":"2023-01-13T15:55:18.000Z","comments":true,"path":"api/articles/Linux-实用命令.json","keywords":"C语言,Cpp,Linux,GoPython,算法,编程技术","cover":[],"text":"实用命令：1、查看端口占用情况123456789101112131415# 查看该端口是否被占用netstat -lnp|grep 5000# 查看端口是否被占...","permalink":"/post/Linux-实用命令","photos":[],"count_time":{"symbolsCount":"5.4k","symbolsTime":"5 mins."},"categories":[{"name":"技术教程","slug":"技术教程","count":4,"path":"api/categories/技术教程.json"}],"tags":[{"name":"linux","slug":"linux","count":1,"path":"api/tags/linux.json"},{"name":"实用命令","slug":"实用命令","count":1,"path":"api/tags/实用命令.json"}],"author":{"name":"Miloce","slug":"blog-author","avatar":"https://q1.qlogo.cn/g?b=qq&nk=2855595515&s=640","link":"/","description":"我们徜徉在璀璨夺目的星辰之下，乘风破浪驰骋在这比特之海","socials":{"github":"https://github.com/miloce","twitter":"https://x.com/jystnet?s=09","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/7647256486","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"iconfont icon-bilibili-fill","link":"https://space.bilibili.com/518758949"},"douyin":{"icon":"iconfont icon-douyin","link":"https://www.douyin.com/user/MS4wLjABAAAA2ti_VUrbdGrI4X2IAXbXs5PI9Yb8XsU0eR5hrI_TGtg"},"QQ":{"icon":"iconfont icon-QQ","link":"https://wpa.qq.com/msgrd?v=3&uin=2855595515&site=qq&menu=yes&jumpflag=1"}}}}}}